{"ast":null,"code":"import _objectSpread from\"/workspace/GitP_Fal/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/workspace/GitP_Fal/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useReducer,useEffect}from'react';import{ProductContext}from'../../context/Context';import{arrayReducer}from'../../reducers/arrayReducer';import{toast}from'react-toastify';import{getItemFromStore,setItemToStore}from'../../helpers/utils';import rawProducts from'../../data/e-commerce/products';import CartModal from'./shopping-cart/CartModal';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var promoCodes=[{code:'GET20',discount:20},{code:'GET50',discount:50}];// dummy promo codes\nvar ProductProvider=function ProductProvider(_ref){var children=_ref.children;// Reducer\nvar _useReducer=useReducer(arrayReducer,[],function(){return getItemFromStore('products',rawProducts);}),_useReducer2=_slicedToArray(_useReducer,2),products=_useReducer2[0],productsDispatch=_useReducer2[1];var _useReducer3=useReducer(arrayReducer,[],function(){return getItemFromStore('shoppingCart',[{id:rawProducts[0].id,quantity:3},{id:rawProducts[1].id,quantity:3},{id:rawProducts[2].id,quantity:3}]);}),_useReducer4=_slicedToArray(_useReducer3,2),shoppingCart=_useReducer4[0],shoppingCartDispatch=_useReducer4[1];var _useReducer5=useReducer(arrayReducer,[],function(){return getItemFromStore('favouriteItems',[{id:rawProducts[0].id},{id:rawProducts[1].id}]);}),_useReducer6=_slicedToArray(_useReducer5,2),favouriteItems=_useReducer6[0],favouriteItemsDispatch=_useReducer6[1];var _useState=useState(getItemFromStore('promo','',sessionStorage)),_useState2=_slicedToArray(_useState,2),promo=_useState2[0],setPromo=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),appliedPromo=_useState4[0],setAppliedPromo=_useState4[1];// State\nvar _useState5=useState('list'),_useState6=_slicedToArray(_useState5,2),productsLayout=_useState6[0],setProductsLayout=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isAsc=_useState8[0],setIsAsc=_useState8[1];var _useState9=useState('price'),_useState10=_slicedToArray(_useState9,2),sortBy=_useState10[0],setSortBy=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),modal=_useState12[0],setModal=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),cartModal=_useState14[0],setCartModal=_useState14[1];// Helper\nvar isInShoppingCart=function isInShoppingCart(id){return!!shoppingCart.find(function(shoppingCartItem){return shoppingCartItem.id===id;});};var isInFavouriteItems=function isInFavouriteItems(id){return!!favouriteItems.find(function(favouriteItem){return favouriteItem.id===id;});};var applyPromoCode=function applyPromoCode(promoCode){// Get your promo codes from your sources\nvar searchPromo=promoCodes.find(function(reservedPromoCode){return reservedPromoCode.code===promoCode;});if(!!searchPromo){setPromo(promoCode);setAppliedPromo(searchPromo);toast.success(/*#__PURE__*/_jsxs(\"span\",{children:[\"Congratulations, You got \",/*#__PURE__*/_jsxs(\"strong\",{children:[searchPromo.discount,\"%\"]}),\" discount!\"]}));}else{setPromo('');setAppliedPromo(null);toast.error('Promo code is not valid! Try again.');}};var handleCartAction=function handleCartAction(_ref2){var id=_ref2.id,_ref2$quantity=_ref2.quantity,quantity=_ref2$quantity===void 0?1:_ref2$quantity,_ref2$type=_ref2.type,type=_ref2$type===void 0?'ADD':_ref2$type;setCartModal(_objectSpread(_objectSpread({},products.find(function(product){return product.id===id;})),{},{quantity:quantity,type:type}));// Dispatch\ntype==='REMOVE'&&shoppingCartDispatch({type:type,id:id});if(type==='ADD'&&!isInShoppingCart(id)){shoppingCartDispatch({type:type,payload:{id:id,quantity:quantity}});}else{shoppingCartDispatch({id:id,type:'EDIT',payload:{id:id,quantity:quantity+shoppingCart.find(function(shoppingCartItem){return shoppingCartItem.id===id;}).quantity}});}// Modal control\nsetModal(!modal);};// Handler\nvar handleSort=function handleSort(newSortBy){setSortBy(newSortBy);productsDispatch({type:'SORT',order:[isAsc?'desc':'asc'],sortBy:sortBy});sortBy===newSortBy&&setIsAsc(!isAsc);};// Life-cycle\nuseEffect(function(){setAppliedPromo(promoCodes.find(function(reservedPromoCode){return reservedPromoCode.code===promo;}));},[promo]);useEffect(function(){setItemToStore('products',products);},[products]);useEffect(function(){setItemToStore('shoppingCart',shoppingCart);},[shoppingCart]);useEffect(function(){setItemToStore('favouriteItems',favouriteItems);},[favouriteItems]);useEffect(function(){setItemToStore('promo',promo,sessionStorage);},[promo]);var value={products:products,productsDispatch:productsDispatch,shoppingCart:shoppingCart,shoppingCartDispatch:shoppingCartDispatch,productsLayout:productsLayout,setProductsLayout:setProductsLayout,sortBy:sortBy,isAsc:isAsc,favouriteItems:favouriteItems,favouriteItemsDispatch:favouriteItemsDispatch,handleSort:handleSort,isInShoppingCart:isInShoppingCart,isInFavouriteItems:isInFavouriteItems,applyPromoCode:applyPromoCode,appliedPromo:appliedPromo,handleCartAction:handleCartAction};return/*#__PURE__*/_jsxs(ProductContext.Provider,{value:value,children:[children,/*#__PURE__*/_jsx(CartModal,_objectSpread(_objectSpread({},cartModal),{},{modal:modal,setModal:setModal}))]});};export default ProductProvider;","map":{"version":3,"sources":["/workspace/GitP_Fal/src/components/e-commerce/ProductProvider.js"],"names":["React","useState","useReducer","useEffect","ProductContext","arrayReducer","toast","getItemFromStore","setItemToStore","rawProducts","CartModal","promoCodes","code","discount","ProductProvider","children","products","productsDispatch","id","quantity","shoppingCart","shoppingCartDispatch","favouriteItems","favouriteItemsDispatch","sessionStorage","promo","setPromo","appliedPromo","setAppliedPromo","productsLayout","setProductsLayout","isAsc","setIsAsc","sortBy","setSortBy","modal","setModal","cartModal","setCartModal","isInShoppingCart","find","shoppingCartItem","isInFavouriteItems","favouriteItem","applyPromoCode","promoCode","searchPromo","reservedPromoCode","success","error","handleCartAction","type","product","payload","handleSort","newSortBy","order","value"],"mappings":"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","sourcesContent":["import React, { useState, useReducer, useEffect } from 'react';\nimport { ProductContext } from '../../context/Context';\nimport { arrayReducer } from '../../reducers/arrayReducer';\nimport { toast } from 'react-toastify';\nimport { getItemFromStore, setItemToStore } from '../../helpers/utils';\nimport rawProducts from '../../data/e-commerce/products';\nimport CartModal from './shopping-cart/CartModal';\n\nconst promoCodes = [{ code: 'GET20', discount: 20 }, { code: 'GET50', discount: 50 }]; // dummy promo codes\n\nconst ProductProvider = ({ children }) => {\n  // Reducer\n  const [products, productsDispatch] = useReducer(arrayReducer, [], () => getItemFromStore('products', rawProducts));\n  const [shoppingCart, shoppingCartDispatch] = useReducer(arrayReducer, [], () =>\n    getItemFromStore('shoppingCart', [\n      { id: rawProducts[0].id, quantity: 3 },\n      { id: rawProducts[1].id, quantity: 3 },\n      { id: rawProducts[2].id, quantity: 3 }\n    ])\n  );\n  const [favouriteItems, favouriteItemsDispatch] = useReducer(arrayReducer, [], () =>\n    getItemFromStore('favouriteItems', [{ id: rawProducts[0].id }, { id: rawProducts[1].id }])\n  );\n  const [promo, setPromo] = useState(getItemFromStore('promo', '', sessionStorage));\n  const [appliedPromo, setAppliedPromo] = useState(null);\n\n  // State\n  const [productsLayout, setProductsLayout] = useState('list');\n  const [isAsc, setIsAsc] = useState(true);\n  const [sortBy, setSortBy] = useState('price');\n  const [modal, setModal] = useState(false);\n  const [cartModal, setCartModal] = useState(null);\n\n  // Helper\n  const isInShoppingCart = id => !!shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id);\n  const isInFavouriteItems = id => !!favouriteItems.find(favouriteItem => favouriteItem.id === id);\n  const applyPromoCode = promoCode => {\n    // Get your promo codes from your sources\n    const searchPromo = promoCodes.find(reservedPromoCode => reservedPromoCode.code === promoCode);\n    if (!!searchPromo) {\n      setPromo(promoCode);\n      setAppliedPromo(searchPromo);\n      toast.success(\n        <span>\n          Congratulations, You got <strong>{searchPromo.discount}%</strong> discount!\n        </span>\n      );\n    } else {\n      setPromo('');\n      setAppliedPromo(null);\n      toast.error('Promo code is not valid! Try again.');\n    }\n  };\n\n  const handleCartAction = ({ id, quantity = 1, type = 'ADD' }) => {\n    setCartModal({ ...products.find(product => product.id === id), quantity, type });\n\n    // Dispatch\n    type === 'REMOVE' && shoppingCartDispatch({ type, id });\n    if (type === 'ADD' && !isInShoppingCart(id)) {\n      shoppingCartDispatch({ type, payload: { id, quantity } });\n    } else {\n      shoppingCartDispatch({\n        id,\n        type: 'EDIT',\n        payload: { id, quantity: quantity + shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id).quantity }\n      });\n    }\n    // Modal control\n    setModal(!modal);\n  };\n\n  // Handler\n  const handleSort = newSortBy => {\n    setSortBy(newSortBy);\n    productsDispatch({ type: 'SORT', order: [isAsc ? 'desc' : 'asc'], sortBy });\n    sortBy === newSortBy && setIsAsc(!isAsc);\n  };\n\n  // Life-cycle\n  useEffect(() => {\n    setAppliedPromo(promoCodes.find(reservedPromoCode => reservedPromoCode.code === promo));\n  }, [promo]);\n\n  useEffect(() => {\n    setItemToStore('products', products);\n  }, [products]);\n\n  useEffect(() => {\n    setItemToStore('shoppingCart', shoppingCart);\n  }, [shoppingCart]);\n\n  useEffect(() => {\n    setItemToStore('favouriteItems', favouriteItems);\n  }, [favouriteItems]);\n\n  useEffect(() => {\n    setItemToStore('promo', promo, sessionStorage);\n  }, [promo]);\n\n  const value = {\n    products,\n    productsDispatch,\n    shoppingCart,\n    shoppingCartDispatch,\n    productsLayout,\n    setProductsLayout,\n    sortBy,\n    isAsc,\n    favouriteItems,\n    favouriteItemsDispatch,\n    handleSort,\n    isInShoppingCart,\n    isInFavouriteItems,\n    applyPromoCode,\n    appliedPromo,\n    handleCartAction\n  };\n\n  return (\n    <ProductContext.Provider value={value}>\n      {children}\n      <CartModal {...cartModal} modal={modal} setModal={setModal} />\n    </ProductContext.Provider>\n  );\n};\n\nexport default ProductProvider;\n"]},"metadata":{},"sourceType":"module"}